<!DOCTYPE html>
<html lang="id" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Pendidikan Adaptif - Siklus Air</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap');
        
        :root {
            --glass-border: rgba(0, 0, 0, 0.1);
            --glass-bg: rgba(255, 255, 255, 0.7);
            --glass-shadow: 0 4px 30px rgba(0, 0, 0, 0.05);
        }

        /* Dark Mode Variables */
        .dark {
            --glass-border: rgba(255, 255, 255, 0.05);
            --glass-bg: rgba(255, 255, 255, 0.03);
            --glass-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: #F3F4F6; /* Gray 100 (Light) */
            color: #1F2937; /* Gray 800 */
            overflow-x: hidden;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .dark body {
            background-color: #030712; /* Gray 950 (Dark) */
            color: #F9FAFB;
        }

        /* Glassmorphism Card Style - Adaptive */
        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .glass-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 40px -10px rgba(6, 182, 212, 0.15);
        }

        /* Inputs - Adaptive */
        .glass-input {
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(0, 0, 0, 0.1);
            color: #1F2937;
            transition: all 0.3s ease;
        }

        .dark .glass-input {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
        }

        .glass-input:focus {
            border-color: #06b6d4;
            outline: none;
            box-shadow: 0 0 0 3px rgba(6, 182, 212, 0.2);
        }

        /* Gradient Text */
        .text-gradient {
            background: linear-gradient(135deg, #0891b2 0%, #7c3aed 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .dark .text-gradient {
            background: linear-gradient(135deg, #22d3ee 0%, #a78bfa 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Animations */
        @keyframes pulse-glow {
            0%, 100% { opacity: 0.4; transform: scale(1); }
            50% { opacity: 0.6; transform: scale(1.1); }
        }
        .animate-pulse-glow { animation: pulse-glow 6s ease-in-out infinite; }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-up { animation: fadeInUp 0.8s ease-out forwards; }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        .animate-shimmer { animation: shimmer 2s infinite; }

        @keyframes spin-slow {
            to { transform: rotate(360deg); }
        }
        .animate-spin-slow { animation: spin-slow 10s linear infinite; }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        .dark ::-webkit-scrollbar-thumb { background: #374151; }
        .dark ::-webkit-scrollbar-thumb:hover { background: #4b5563; }
    </style>
    <script>
        tailwind.config = {
            darkMode: 'class', // Enable manual toggle
            theme: {
                extend: {
                    colors: {
                        cyan: { 450: '#00a3cc' },
                        violet: { 450: '#7c3aed' }
                    }
                }
            }
        }
    </script>
</head>
<body class="antialiased selection:bg-cyan-500/30 selection:text-cyan-800 dark:selection:text-cyan-200 min-h-screen pb-12">

    <!-- Background Elements (Adaptive) -->
    <div class="fixed inset-0 z-0 overflow-hidden pointer-events-none">
        <!-- Light Mode Blobs -->
        <div class="absolute top-[-10%] left-[-10%] w-[600px] h-[600px] bg-cyan-200/40 rounded-full blur-[100px] animate-pulse-glow dark:hidden"></div>
        <div class="absolute bottom-[-10%] right-[-10%] w-[600px] h-[600px] bg-violet-200/40 rounded-full blur-[100px] animate-pulse-glow dark:hidden" style="animation-delay: 2s;"></div>
        
        <!-- Dark Mode Blobs -->
        <div class="hidden dark:block absolute top-[-10%] left-[-10%] w-[600px] h-[600px] bg-cyan-600/10 rounded-full blur-[120px] mix-blend-screen animate-pulse-glow"></div>
        <div class="hidden dark:block absolute bottom-[-10%] right-[-10%] w-[600px] h-[600px] bg-violet-600/10 rounded-full blur-[120px] mix-blend-screen animate-pulse-glow" style="animation-delay: 2s;"></div>
        
        <!-- Texture -->
        <div class="absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20 dark:opacity-10 brightness-100 contrast-150"></div>
    </div>

    <!-- HEADER -->
    <nav class="fixed w-full z-50 top-0 left-0 border-b border-gray-200/50 dark:border-white/5 bg-white/70 dark:bg-[#030712]/80 backdrop-blur-md transition-colors duration-300">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center gap-2">
                    <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center text-white shadow-lg shadow-cyan-500/30">
                        <i data-lucide="brain-circuit" class="w-5 h-5"></i>
                    </div>
                    <span class="font-bold text-lg tracking-tight text-gray-900 dark:text-white">Didaktika <span class="font-light opacity-80">AI</span></span>
                </div>
                
                <div class="flex items-center gap-3">
                    <button id="btn-reset" onclick="resetApp()" class="hidden flex items-center gap-2 bg-gray-100 dark:bg-white/5 hover:bg-gray-200 dark:hover:bg-white/10 border border-gray-200 dark:border-white/10 px-4 py-1.5 rounded-full text-xs font-medium transition-colors text-gray-700 dark:text-gray-200">
                        <i data-lucide="rotate-ccw" class="w-3 h-3"></i> Reset
                    </button>
                    
                    <!-- Dark Mode Toggle -->
                    <button onclick="toggleTheme()" class="p-2 rounded-full bg-gray-100 dark:bg-white/5 hover:bg-gray-200 dark:hover:bg-white/10 text-gray-700 dark:text-yellow-400 transition-all border border-gray-200 dark:border-white/10">
                        <i data-lucide="sun" class="w-5 h-5 hidden dark:block"></i>
                        <i data-lucide="moon" class="w-5 h-5 block dark:hidden text-gray-600"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- MAIN CONTENT -->
    <main class="relative z-10 max-w-7xl mx-auto px-4 py-24 md:py-32">
        
        <!-- SECTION 1: INPUT GURU (CENTERED LAYOUT) -->
        <div id="section-input" class="animate-fade-up max-w-4xl mx-auto">
            
            <!-- HEADER TEXT -->
            <div class="text-center mb-10">
                <h1 class="text-4xl md:text-6xl font-extrabold tracking-tight mb-4 text-gray-900 dark:text-white">
                    Transformasi <span class="text-gradient">Materi Ajar</span>
                </h1>
                <p class="text-gray-600 dark:text-gray-400 text-lg max-w-2xl mx-auto">
                    Ubah teks mentah menjadi modul pembelajaran interaktif yang adaptif untuk berbagai gaya belajar siswa dalam hitungan detik.
                </p>
            </div>

            <!-- MAIN INPUT CARD (CENTERED) -->
            <div class="glass-card rounded-3xl p-6 md:p-10 shadow-2xl relative z-20">
                <div class="space-y-6">
                    <!-- Judul -->
                    <div>
                        <label class="block text-sm font-bold text-gray-700 dark:text-cyan-200 mb-2">Judul Materi / Topik</label>
                        <input id="input-title" type="text" class="w-full p-4 rounded-xl glass-input placeholder-gray-400 text-lg font-medium" value="Siklus Hidrologi (Air)">
                    </div>

                    <!-- Konten -->
                    <div>
                        <label class="block text-sm font-bold text-gray-700 dark:text-cyan-200 mb-2">Teks Materi Dasar</label>
                        <textarea id="input-content" class="w-full p-4 rounded-xl glass-input h-48 text-sm leading-relaxed placeholder-gray-400">Siklus air (hidrologi) adalah proses sirkulasi air yang terus-menerus terjadi dari atmosfer ke bumi dan kembali lagi ke atmosfer. Proses ini menjamin ketersediaan air di bumi untuk makhluk hidup.

Tahapan utama:
1. Evaporasi (Penguapan): Air laut menguap karena panas matahari menjadi uap gas.
2. Kondensasi (Pengembunan): Uap air mendingin menjadi titik air dan membentuk awan.
3. Presipitasi (Hujan): Awan yang berat menurunkan air kembali ke bumi.
4. Infiltrasi: Air hujan meresap ke dalam pori-pori tanah menjadi air tanah.</textarea>
                    </div>

                    <!-- URL -->
                    <div>
                        <label class="block text-sm font-bold text-gray-700 dark:text-cyan-200 mb-2">Sumber Video (YouTube)</label>
                        <div class="relative">
                            <i data-lucide="link" class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 w-5 h-5"></i>
                            <input id="input-url" type="text" class="w-full pl-12 p-4 rounded-xl glass-input placeholder-gray-400" value="https://www.youtube.com/watch?v=9pqh6cmEOhs">
                        </div>
                    </div>
                    
                    <!-- Button -->
                    <div class="pt-4">
                        <button onclick="startAnalysis()" class="w-full group relative overflow-hidden rounded-xl bg-gradient-to-r from-cyan-600 to-blue-600 dark:from-cyan-500 dark:to-violet-600 p-px font-bold text-white shadow-xl transition-all hover:shadow-cyan-500/40 active:scale-[0.98]">
                            <div class="relative flex items-center justify-center gap-2 rounded-xl bg-white/10 dark:bg-black/20 px-8 py-4 transition-all group-hover:bg-transparent">
                                <i data-lucide="wand-2" class="w-5 h-5"></i>
                                Generate Smart Content
                            </div>
                        </button>
                    </div>
                </div>
            </div>

            <!-- FEATURES GRID (BELOW INPUT) -->
            <div class="mt-16 grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Feature 1 -->
                <div class="glass-card p-6 rounded-2xl flex flex-col items-center text-center hover:bg-white/50 dark:hover:bg-white/5 transition-all">
                    <div class="p-3 mb-4 rounded-xl bg-blue-100 dark:bg-blue-500/20 text-blue-600 dark:text-blue-400">
                        <i data-lucide="eye" class="w-8 h-8"></i>
                    </div>
                    <h3 class="font-bold text-gray-900 dark:text-white mb-2">Visualisasi Dinamis</h3>
                    <p class="text-sm text-gray-500 dark:text-gray-400">Teks diubah otomatis menjadi diagram SVG interaktif dan referensi visual.</p>
                </div>

                <!-- Feature 2 -->
                <div class="glass-card p-6 rounded-2xl flex flex-col items-center text-center hover:bg-white/50 dark:hover:bg-white/5 transition-all">
                    <div class="p-3 mb-4 rounded-xl bg-violet-100 dark:bg-violet-500/20 text-violet-600 dark:text-violet-400">
                        <i data-lucide="headphones" class="w-8 h-8"></i>
                    </div>
                    <h3 class="font-bold text-gray-900 dark:text-white mb-2">Narasi Audio</h3>
                    <p class="text-sm text-gray-500 dark:text-gray-400">Konversi materi menjadi podcast storytelling yang menarik untuk pelajar auditori.</p>
                </div>

                <!-- Feature 3 -->
                <div class="glass-card p-6 rounded-2xl flex flex-col items-center text-center hover:bg-white/50 dark:hover:bg-white/5 transition-all">
                    <div class="p-3 mb-4 rounded-xl bg-rose-100 dark:bg-rose-500/20 text-rose-600 dark:text-rose-400">
                        <i data-lucide="activity" class="w-8 h-8"></i>
                    </div>
                    <h3 class="font-bold text-gray-900 dark:text-white mb-2">Aktivitas Kinestetik</h3>
                    <p class="text-sm text-gray-500 dark:text-gray-400">Ide eksperimen mini dan studi kasus nyata untuk pemahaman mendalam.</p>
                </div>
            </div>
            
            <div class="mt-8 text-center">
                <span class="inline-block px-4 py-1.5 rounded-full bg-yellow-500/10 border border-yellow-500/20 text-yellow-600 dark:text-yellow-500 text-xs font-semibold">
                    ðŸ’¡ Mode Demo: Data contoh sudah diisi. Klik tombol "Generate" untuk melihat hasil.
                </span>
            </div>
        </div>

        <!-- SECTION 2: ANALYZING (LOADING) -->
        <div id="section-analyzing" class="hidden flex flex-col items-center justify-center min-h-[500px] glass-card rounded-3xl p-10 text-center animate-fade-up mx-auto max-w-4xl">
            <div class="relative mb-8">
                <div class="absolute inset-0 bg-cyan-500 rounded-full blur-xl opacity-20 animate-pulse"></div>
                <div class="bg-white dark:bg-[#0B0F19] p-6 rounded-full border border-cyan-500/30 relative z-10 shadow-lg">
                    <i data-lucide="cpu" class="w-16 h-16 text-cyan-500 animate-pulse"></i>
                </div>
            </div>

            <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-2">AI Sedang Bekerja</h2>
            <p id="analyzing-text" class="text-gray-600 dark:text-gray-400 mb-8 h-6 font-medium text-lg">Menganalisis struktur teks...</p>

            <!-- Progress Bar -->
            <div class="w-full max-w-md bg-gray-200 dark:bg-gray-800 rounded-full h-2 mb-8 overflow-hidden">
                <div id="progress-bar" class="bg-gradient-to-r from-cyan-500 to-violet-500 h-full rounded-full transition-all duration-300 ease-out relative w-0 shadow-[0_0_10px_rgba(34,211,238,0.5)]">
                    <div class="absolute inset-0 bg-white/30 animate-shimmer"></div>
                </div>
            </div>
            
            <!-- Badges -->
            <div class="flex flex-wrap justify-center gap-3 text-xs font-mono" id="step-indicators">
                <div id="step-visual" class="px-4 py-2 rounded-lg bg-gray-100 dark:bg-white/5 border border-gray-200 dark:border-white/5 text-gray-500 transition-all duration-300">VISUAL</div>
                <div id="step-audio" class="px-4 py-2 rounded-lg bg-gray-100 dark:bg-white/5 border border-gray-200 dark:border-white/5 text-gray-500 transition-all duration-300">AUDIO</div>
                <div id="step-kinestetik" class="px-4 py-2 rounded-lg bg-gray-100 dark:bg-white/5 border border-gray-200 dark:border-white/5 text-gray-500 transition-all duration-300">KINESTETIK</div>
                <div id="step-quiz" class="px-4 py-2 rounded-lg bg-gray-100 dark:bg-white/5 border border-gray-200 dark:border-white/5 text-gray-500 transition-all duration-300">EVALUASI</div>
            </div>
        </div>

        <!-- SECTION 3: LEARNING CONTENT -->
        <div id="section-learning" class="hidden animate-fade-up space-y-8 max-w-5xl mx-auto">
            <!-- Title Bar -->
            <div class="glass-card p-6 rounded-2xl flex flex-col md:flex-row items-center justify-between gap-4">
                <div>
                    <span class="text-xs font-bold text-cyan-600 dark:text-cyan-400 uppercase tracking-wider mb-1 block">Materi Aktif</span>
                    <h2 id="result-title" class="text-2xl font-bold text-gray-900 dark:text-white">Judul Materi</h2>
                </div>
                <div class="flex gap-2">
                    <span class="bg-emerald-500/10 border border-emerald-500/20 text-emerald-600 dark:text-emerald-400 text-xs px-3 py-1.5 rounded-full font-medium flex items-center gap-1.5"><i data-lucide="check-circle" class="w-3 h-3"></i> Visual</span>
                    <span class="bg-emerald-500/10 border border-emerald-500/20 text-emerald-600 dark:text-emerald-400 text-xs px-3 py-1.5 rounded-full font-medium flex items-center gap-1.5"><i data-lucide="check-circle" class="w-3 h-3"></i> Audio</span>
                    <span class="bg-emerald-500/10 border border-emerald-500/20 text-emerald-600 dark:text-emerald-400 text-xs px-3 py-1.5 rounded-full font-medium flex items-center gap-1.5"><i data-lucide="check-circle" class="w-3 h-3"></i> Kinestetik</span>
                </div>
            </div>

            <!-- Tabs Navigation -->
            <div class="flex flex-wrap gap-3 p-1 glass-card rounded-2xl">
                <button onclick="switchTab('visual')" id="tab-btn-visual" class="flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-xl font-semibold transition-all duration-300 bg-gradient-to-r from-cyan-500 to-blue-500 text-white shadow-lg">
                    <i data-lucide="eye" class="w-4 h-4"></i> Visual
                </button>
                <button onclick="switchTab('audio')" id="tab-btn-audio" class="flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-xl font-semibold transition-all duration-300 text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-black/5 dark:hover:bg-white/5">
                    <i data-lucide="headphones" class="w-4 h-4"></i> Audio
                </button>
                <button onclick="switchTab('kinestetik')" id="tab-btn-kinestetik" class="flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-xl font-semibold transition-all duration-300 text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-black/5 dark:hover:bg-white/5">
                    <i data-lucide="hand" class="w-4 h-4"></i> Kinestetik
                </button>
            </div>

            <!-- Content Container -->
            <div class="glass-card rounded-3xl p-6 md:p-8 min-h-[500px]">
                
                <!-- 1. VISUAL CONTENT -->
                <div id="content-visual" class="space-y-8 animate-fade-in">
                    <div class="flex items-center gap-3 mb-6">
                        <div class="p-2 bg-cyan-100 dark:bg-cyan-500/20 rounded-lg text-cyan-600 dark:text-cyan-400"><i data-lucide="image" class="w-6 h-6"></i></div>
                        <h2 class="text-2xl font-bold text-gray-900 dark:text-white">Visualisasi Konsep</h2>
                    </div>

                    <!-- SVG Diagram (Nature Container) - REVERTED TO ANIMATED SVG -->
                    <div class="w-full aspect-video bg-gradient-to-b from-sky-300 to-sky-50 dark:from-sky-900 dark:to-sky-950 rounded-2xl overflow-hidden relative shadow-xl border-4 border-white dark:border-white/10 transition-colors">
                        <svg class="w-full h-full" viewBox="0 0 800 400" preserveAspectRatio="none">
                            <!-- Matahari -->
                            <circle cx="700" cy="60" r="40" fill="#FDB813">
                                <animate attributeName="opacity" values="1;0.8;1" dur="2s" repeatCount="indefinite" />
                            </circle>
                            <circle cx="700" cy="60" r="50" fill="none" stroke="#FDB813" stroke-width="2" stroke-dasharray="5,5" class="animate-spin-slow" />

                            <!-- Gunung -->
                            <path d="M0,400 L200,150 L400,400 Z" fill="#7C90DB" opacity="0.6" />
                            <path d="M100,400 L300,100 L550,400 Z" fill="#5A71BF" />
                            
                            <!-- Tanah -->
                            <rect x="0" y="380" width="800" height="20" fill="#5D4037" />

                            <!-- Laut -->
                            <path d="M400,350 C500,340 700,360 800,350 L800,400 L400,400 Z" fill="#0288D1" />
                            
                            <!-- Awan -->
                            <g transform="translate(100, 50)" fill="#FFFFFF" opacity="0.9">
                                <path d="M25,25 C10,25 0,35 0,50 C0,65 15,75 25,75 L75,75 C90,75 100,65 100,50 C100,30 85,15 70,15 C60,0 35,0 25,25" />
                            </g>
                            <g transform="translate(450, 60)" fill="#FFFFFF" opacity="0.8">
                                <path d="M25,25 C10,25 0,35 0,50 C0,65 15,75 25,75 L75,75 C90,75 100,65 100,50 C100,30 85,15 70,15 C60,0 35,0 25,25" />
                            </g>

                            <!-- Panah Evaporasi (Naik) -->
                            <g stroke="#D84315" stroke-width="3" fill="none" stroke-dasharray="10,5">
                                <path d="M600,350 Q620,250 600,150">
                                    <animate attributeName="stroke-dashoffset" from="100" to="0" dur="2s" repeatCount="indefinite" />
                                </path>
                                <path d="M650,360 Q670,260 650,160">
                                    <animate attributeName="stroke-dashoffset" from="100" to="0" dur="2s" repeatCount="indefinite" begin="0.5s" />
                                </path>
                            </g>
                            <!-- Text Outline for better visibility on both modes -->
                            <text x="630" y="200" fill="#BF360C" font-size="16" font-weight="bold" style="font-family: sans-serif; text-shadow: 1px 1px 0px rgba(255,255,255,0.8);">Evaporasi</text>

                            <!-- Panah Kondensasi (Geser) -->
                            <path d="M550,80 L200,80" stroke="#37474F" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead)" />
                            <text x="350" y="70" fill="#263238" font-size="16" font-weight="bold" style="font-family: sans-serif; text-shadow: 1px 1px 0px rgba(255,255,255,0.8);">Kondensasi</text>

                            <!-- Hujan (Presipitasi) -->
                            <g stroke="#0277BD" stroke-width="2">
                                <line x1="150" y1="120" x2="140" y2="150" opacity="0.7">
                                    <animate attributeName="y1" from="120" to="300" dur="1.5s" repeatCount="indefinite" />
                                    <animate attributeName="y2" from="150" to="330" dur="1.5s" repeatCount="indefinite" />
                                </line>
                                <line x1="180" y1="130" x2="170" y2="160" opacity="0.7">
                                    <animate attributeName="y1" from="130" to="310" dur="1.2s" repeatCount="indefinite" />
                                    <animate attributeName="y2" from="160" to="340" dur="1.2s" repeatCount="indefinite" />
                                </line>
                            </g>
                            <text x="80" y="200" fill="#01579B" font-size="16" font-weight="bold" style="font-family: sans-serif; text-shadow: 1px 1px 0px rgba(255,255,255,0.8);">Presipitasi</text>

                            <!-- Infiltrasi -->
                            <path d="M300,400 Q400,380 500,390" stroke="#2E7D32" stroke-width="3" fill="none" stroke-dasharray="5,5" />
                            <text x="350" y="370" fill="#1B5E20" font-size="16" font-weight="bold" style="font-family: sans-serif; text-shadow: 1px 1px 0px rgba(255,255,255,0.8);">Infiltrasi</text>

                            <defs>
                                <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                                    <polygon points="0 0, 10 3.5, 0 7" fill="#37474F" />
                                </marker>
                            </defs>
                        </svg>
                    </div>

                    <!-- Video Iframe -->
                    <div id="video-container" class="bg-gray-100 dark:bg-[#0B0F19] p-4 rounded-2xl border border-gray-200 dark:border-white/10">
                        <div class="flex items-center gap-2 mb-4">
                            <i data-lucide="youtube" class="text-red-500 w-5 h-5"></i>
                            <h3 class="font-bold text-lg text-gray-900 dark:text-white">Video Referensi</h3>
                        </div>
                        <div class="aspect-video w-full rounded-xl overflow-hidden shadow-lg bg-black/50">
                            <iframe id="youtube-frame" width="100%" height="100%" src="" title="Video" frameborder="0" allowfullscreen></iframe>
                        </div>
                    </div>

                    <!-- Kartu Penjelasan Tahapan -->
                    <div>
                        <h3 class="font-bold text-lg text-gray-900 dark:text-white mb-6 flex items-center gap-2">
                            <i data-lucide="layers" class="text-cyan-500 dark:text-cyan-400 w-5 h-5"></i>
                            Tahapan Proses
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <!-- Step 1 -->
                            <div class="glass-card rounded-2xl p-5 border-l-4 border-l-orange-500 hover:bg-gray-100 dark:hover:bg-white/5 transition-colors">
                                <div class="flex items-start gap-4">
                                    <div class="p-2 rounded-lg bg-orange-100 dark:bg-orange-500/20 text-orange-500 dark:text-orange-400"><i data-lucide="sun" class="w-5 h-5"></i></div>
                                    <div>
                                        <h4 class="font-bold text-lg mb-1 text-orange-600 dark:text-orange-300">1. Evaporasi</h4>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">Air dari laut & sungai berubah menjadi uap karena panas matahari. Uap naik ke atmosfer.</p>
                                    </div>
                                </div>
                            </div>
                            <!-- Step 2 -->
                            <div class="glass-card rounded-2xl p-5 border-l-4 border-l-gray-400 hover:bg-gray-100 dark:hover:bg-white/5 transition-colors">
                                <div class="flex items-start gap-4">
                                    <div class="p-2 rounded-lg bg-gray-200 dark:bg-gray-500/20 text-gray-600 dark:text-gray-300"><i data-lucide="cloud" class="w-5 h-5"></i></div>
                                    <div>
                                        <h4 class="font-bold text-lg mb-1 text-gray-700 dark:text-gray-200">2. Kondensasi</h4>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">Uap air mendingin dan berubah menjadi butiran air atau es, membentuk awan putih.</p>
                                    </div>
                                </div>
                            </div>
                            <!-- Step 3 -->
                            <div class="glass-card rounded-2xl p-5 border-l-4 border-l-blue-500 hover:bg-gray-100 dark:hover:bg-white/5 transition-colors">
                                <div class="flex items-start gap-4">
                                    <div class="p-2 rounded-lg bg-blue-100 dark:bg-blue-500/20 text-blue-500 dark:text-blue-400"><i data-lucide="cloud-rain" class="w-5 h-5"></i></div>
                                    <div>
                                        <h4 class="font-bold text-lg mb-1 text-blue-600 dark:text-blue-300">3. Presipitasi</h4>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">Awan jenuh menurunkan air kembali ke bumi dalam bentuk hujan, salju, atau es.</p>
                                    </div>
                                </div>
                            </div>
                            <!-- Step 4 -->
                            <div class="glass-card rounded-2xl p-5 border-l-4 border-l-emerald-500 hover:bg-gray-100 dark:hover:bg-white/5 transition-colors">
                                <div class="flex items-start gap-4">
                                    <div class="p-2 rounded-lg bg-emerald-100 dark:bg-emerald-500/20 text-emerald-500 dark:text-emerald-400"><i data-lucide="arrow-down-circle" class="w-5 h-5"></i></div>
                                    <div>
                                        <h4 class="font-bold text-lg mb-1 text-emerald-600 dark:text-emerald-300">4. Infiltrasi</h4>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">Air hujan meresap ke dalam pori-pori tanah menjadi air tanah atau mengalir kembali ke laut.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quiz Visual -->
                    <div class="glass-card p-6 rounded-2xl border border-cyan-500/20 bg-cyan-50 dark:bg-cyan-900/10">
                        <h3 class="text-xl font-bold mb-6 flex items-center gap-2 text-cyan-700 dark:text-cyan-400">
                            <i data-lucide="help-circle"></i> Evaluasi Visual
                        </h3>
                        <div id="quiz-visual-container" class="space-y-4"></div>
                        <button onclick="checkQuiz('visual')" class="mt-6 w-full py-3 rounded-xl bg-cyan-600 hover:bg-cyan-500 text-white font-bold transition-all shadow-lg shadow-cyan-500/20">Cek Jawaban</button>
                        <div id="result-visual" class="mt-4 font-bold hidden text-center p-3 rounded-lg"></div>
                    </div>
                </div>

                <!-- 2. AUDIO CONTENT -->
                <div id="content-audio" class="hidden space-y-8 animate-fade-in">
                    <div class="flex items-center gap-3 mb-2">
                        <div class="p-2 bg-violet-100 dark:bg-violet-500/20 rounded-lg text-violet-600 dark:text-violet-400"><i data-lucide="mic" class="w-6 h-6"></i></div>
                        <h2 class="text-2xl font-bold text-gray-900 dark:text-white">Podcast Edukasi</h2>
                    </div>
                    
                    <!-- Audio Player Card -->
                    <div class="glass-card rounded-3xl p-8 text-center relative overflow-hidden group">
                        <div class="absolute inset-0 bg-violet-500/5 group-hover:bg-violet-500/10 transition-colors"></div>
                        <div class="relative z-10 flex flex-col items-center">
                            <div class="w-20 h-20 rounded-full bg-violet-100 dark:bg-violet-500/20 flex items-center justify-center mb-6 shadow-[0_0_30px_rgba(139,92,246,0.2)] animate-pulse-glow">
                                <i data-lucide="headphones" class="w-10 h-10 text-violet-600 dark:text-violet-400"></i>
                            </div>
                            <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">Kisah Si Tetes Air</h3>
                            <p class="text-gray-600 dark:text-gray-400 mb-8 max-w-md">Dengarkan perjalanan naratif tentang siklus air dengan gaya penceritaan yang imajinatif.</p>
                            
                            <button onclick="toggleAudio()" id="btn-audio-control" class="flex items-center gap-3 px-8 py-3 rounded-full font-bold text-white transition-all transform hover:scale-105 shadow-lg bg-violet-600 hover:bg-violet-500 shadow-violet-500/30">
                                <i data-lucide="play" class="w-5 h-5"></i> Putar Audio
                            </button>
                        </div>
                    </div>

                    <!-- Transcript -->
                    <div class="glass-card p-6 rounded-2xl border border-gray-200 dark:border-white/5">
                        <h4 class="font-bold text-gray-500 dark:text-gray-300 mb-4 text-xs uppercase tracking-widest border-b border-gray-200 dark:border-white/10 pb-2">Transkrip Narasi</h4>
                        <div id="audio-transcript" class="text-gray-600 dark:text-gray-400 leading-relaxed text-sm h-48 overflow-y-auto pr-2 custom-scrollbar">
                            <!-- Text filled by JS -->
                        </div>
                    </div>

                    <!-- Quiz Audio -->
                    <div class="glass-card p-6 rounded-2xl border border-violet-500/20 bg-violet-50 dark:bg-violet-900/10">
                        <h3 class="text-xl font-bold mb-6 flex items-center gap-2 text-violet-700 dark:text-violet-400">
                            <i data-lucide="help-circle"></i> Evaluasi Audio
                        </h3>
                        <div id="quiz-audio-container" class="space-y-4"></div>
                        <button onclick="checkQuiz('audio')" class="mt-6 w-full py-3 rounded-xl bg-violet-600 hover:bg-violet-500 text-white font-bold transition-all shadow-lg shadow-violet-500/20">Cek Jawaban</button>
                        <div id="result-audio" class="mt-4 font-bold hidden text-center p-3 rounded-lg"></div>
                    </div>
                </div>

                <!-- 3. KINESTHETIC CONTENT -->
                <div id="content-kinestetik" class="hidden space-y-8 animate-fade-in">
                    <div class="flex items-center gap-3 mb-2">
                        <div class="p-2 bg-rose-100 dark:bg-rose-500/20 rounded-lg text-rose-600 dark:text-rose-400"><i data-lucide="activity" class="w-6 h-6"></i></div>
                        <h2 class="text-2xl font-bold text-gray-900 dark:text-white">Aktivitas Praktik</h2>
                    </div>

                    <!-- Aktivitas 1: Mini Lab -->
                    <div class="glass-card rounded-2xl p-6 border-l-4 border-l-rose-500">
                        <h3 class="font-bold text-lg text-gray-900 dark:text-white flex items-center gap-3 mb-4">
                            <span class="bg-rose-500 text-white px-2 py-0.5 rounded text-xs font-bold uppercase tracking-wider">Lab Mini</span>
                            Membuat Hujan Buatan
                        </h3>
                        <div class="grid md:grid-cols-2 gap-6 bg-gray-100 dark:bg-black/20 p-4 rounded-xl">
                            <div>
                                <h4 class="font-semibold text-rose-600 dark:text-rose-400 mb-2 flex items-center gap-2"><i data-lucide="flask-conical" class="w-4 h-4"></i> Alat & Bahan</h4>
                                <ul class="list-disc pl-5 text-sm text-gray-600 dark:text-gray-400 space-y-1">
                                    <li>Toples kaca bening</li>
                                    <li>Air panas</li>
                                    <li>Piring kecil (penutup)</li>
                                    <li>Es batu</li>
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-semibold text-rose-600 dark:text-rose-400 mb-2 flex items-center gap-2"><i data-lucide="list-checks" class="w-4 h-4"></i> Langkah Kerja</h4>
                                <ol class="list-decimal pl-5 text-sm text-gray-600 dark:text-gray-400 space-y-1">
                                    <li>Isi toples dengan air panas (5 cm).</li>
                                    <li>Tutup rapat dengan piring.</li>
                                    <li>Letakkan es batu di atas piring.</li>
                                    <li><strong>Amati:</strong> Tetesan air yang jatuh.</li>
                                </ol>
                            </div>
                        </div>
                    </div>

                    <!-- Aktivitas 2: Jurnal -->
                    <div>
                        <h3 class="font-bold text-lg text-gray-900 dark:text-white mb-3 flex items-center gap-2">
                             <i data-lucide="pen-tool" class="w-5 h-5 text-rose-500"></i>
                             Jurnal Perjalanan Air
                        </h3>
                        <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">
                            Tulis cerita pendek dari sudut pandang "Partikel Air". Gunakan kata: <em>Limpasan</em> dan <em>Evaporasi</em>.
                        </p>
                        <textarea class="w-full p-4 rounded-xl glass-input h-32 text-sm focus:border-rose-500 placeholder-gray-400" placeholder="Hai, namaku Tetes. Aku baru saja jatuh di atap sekolah..."></textarea>
                    </div>

                    <!-- Aktivitas 3: Studi Kasus -->
                    <div class="glass-card p-6 rounded-2xl bg-gradient-to-r from-gray-100 to-transparent dark:from-gray-800/50 dark:to-transparent">
                       <h3 class="font-bold text-lg text-gray-900 dark:text-white mb-2 flex items-center gap-2">
                          <i data-lucide="map-pin" class="w-5 h-5 text-yellow-500"></i>
                          Studi Kasus: Kota Tanpa Tanah?
                       </h3>
                       <p class="text-gray-600 dark:text-gray-400 text-sm">
                         Di kota besar, hampir semua tanah tertutup aspal dan beton. Pohon sangat sedikit. 
                         <br><strong class="text-gray-900 dark:text-white mt-1 block">Bagian mana dari siklus air yang paling terganggu? Apa akibatnya?</strong>
                       </p>
                    </div>

                    <!-- Quiz Kinestetik -->
                    <div class="glass-card p-6 rounded-2xl border border-rose-500/20 bg-rose-50 dark:bg-rose-900/10">
                        <h3 class="text-xl font-bold mb-6 flex items-center gap-2 text-rose-700 dark:text-rose-400">
                            <i data-lucide="help-circle"></i> Evaluasi Praktik
                        </h3>
                        <div id="quiz-kinestetik-container" class="space-y-4"></div>
                        <button onclick="checkQuiz('kinestetik')" class="mt-6 w-full py-3 rounded-xl bg-rose-600 hover:bg-rose-500 text-white font-bold transition-all shadow-lg shadow-rose-500/20">Cek Jawaban</button>
                        <div id="result-kinestetik" class="mt-4 font-bold hidden text-center p-3 rounded-lg"></div>
                    </div>
                </div>

            </div>

            <!-- AI ANALYSIS RESULT -->
            <div id="ai-analysis-card" class="hidden glass-card rounded-3xl p-8 border border-indigo-500/30 bg-gradient-to-r from-indigo-50 to-violet-50 dark:from-indigo-500/10 dark:to-violet-500/10 animate-fade-up">
                <div class="flex flex-col md:flex-row gap-6 items-start">
                    <div class="p-4 bg-indigo-100 dark:bg-indigo-500/20 rounded-full shrink-0">
                        <i data-lucide="brain-circuit" class="w-8 h-8 text-indigo-600 dark:text-indigo-400"></i>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold mb-3 text-gray-900 dark:text-white flex items-center gap-2">
                            Analisis Gaya Belajar
                            <i data-lucide="sparkles" class="w-4 h-4 text-yellow-500 fill-yellow-500"></i>
                        </h3>
                        <p id="ai-analysis-text" class="text-gray-600 dark:text-gray-300 leading-relaxed"></p>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <footer class="border-t border-gray-200 dark:border-white/5 py-8 text-center text-gray-500 text-sm">
        <p>&copy; 2026 Didaktika AI. Teknologi untuk Pendidikan.</p>
    </footer>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // --- DATA & STATE ---
        const narrativeText = `Halo Sobat Belajar! Pernahkah kamu berpikir, air yang kamu minum hari ini, mungkin adalah air yang sama yang pernah diminum oleh dinosaurus jutaan tahun lalu? Kok bisa? Yuk, kita telusuri perjalanannya!

Bayangkan kamu adalah setetes air di samudra yang luas. Matahari bersinar sangat terik hari ini. Tiba-tiba, kamu merasa tubuhmu menjadi ringan, hangat, dan melayang ke udara. Nah, fase ini disebut Evaporasi. Kamu berubah dari air cair menjadi uap gas yang terbang tinggi.

Semakin tinggi kamu terbang, udara semakin dingin. Brrr! Karena dingin, kamu mulai merapatkan diri dengan teman-teman uap air lainnya dan berubah kembali menjadi butiran air kecil. Kalian berkumpul membentuk awan putih yang besar. Proses perubahan dari gas kembali ke cair ini kita sebut Kondensasi.

Lama-kelamaan, awan tempatmu berkumpul semakin padat dan berat. Awan itu tidak kuat lagi menahan beban. Akhirnya... Byurr! Kamu jatuh kembali ke bumi bersama miliaran temanmu. Inilah yang kita sebut hujan, atau dalam bahasa ilmiahnya, Presipitasi.

Setelah sampai di tanah, sebagian dari kalian mengalir ke sungai dan sebagian lagi meresap masuk ke dalam pori-pori tanah, menjadi cadangan air tanah yang segar. Proses meresap ini namanya Infiltrasi.

Dan akhirnya, kamu akan mengalir kembali ke laut, menunggu matahari bersinar lagi, dan siklus pun terulang kembali. Begitulah cara alam menjaga air tetap ada untuk kita!`;

        const quizzes = {
            visual: [
                { q: "Panah merah naik dari laut menggambarkan...", opts: ["Hujan", "Evaporasi", "Aliran"], ans: 1 },
                { q: "Awan terbentuk pada proses...", opts: ["Kondensasi", "Infiltrasi", "Presipitasi"], ans: 0 },
                { q: "Gambar awan menurunkan titik-titik air disebut...", opts: ["Transpirasi", "Presipitasi", "Infiltrasi"], ans: 1 }
            ],
            audio: [
                { q: "Apa yang membuat air melayang ke udara?", opts: ["Angin", "Panas Matahari", "Gravitasi"], ans: 1 },
                { q: "Istilah untuk hujan turun adalah...", opts: ["Evaporasi", "Presipitasi", "Sublimasi"], ans: 1 },
                { q: "Ke mana perginya air setelah Infiltrasi?", opts: ["Langsung ke awan", "Masuk ke pori-pori tanah", "Menguap"], ans: 1 }
            ],
            kinestetik: [
                { q: "Fungsi es batu di percobaan adalah...", opts: ["Memanaskan", "Mendinginkan uap", "Hiasan"], ans: 1 },
                { q: "Jika tanah diaspal, proses apa yang terganggu?", opts: ["Infiltrasi", "Evaporasi", "Kondensasi"], ans: 0 },
                { q: "Apa kesimpulan dari Jurnal Perjalanan?", opts: ["Air diam", "Air berpindah (Siklus)", "Air habis"], ans: 1 }
            ]
        };

        let currentScores = { visual: 0, audio: 0, kinestetik: 0 };
        let isSpeaking = false;

        // --- INITIALIZATION ---
        
        // Theme Toggle Logic
        function initTheme() {
            if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        }

        function toggleTheme() {
            if (document.documentElement.classList.contains('dark')) {
                document.documentElement.classList.remove('dark');
                localStorage.theme = 'light';
            } else {
                document.documentElement.classList.add('dark');
                localStorage.theme = 'dark';
            }
            lucide.createIcons();
        }

        // Run Init
        initTheme();
        lucide.createIcons();
        document.getElementById('audio-transcript').innerText = narrativeText;

        // --- FUNCTIONS ---

        function startAnalysis() {
            const title = document.getElementById('input-title').value;
            const url = document.getElementById('input-url').value;
            
            // UI Transition
            document.getElementById('section-input').classList.add('hidden');
            document.getElementById('section-analyzing').classList.remove('hidden');
            document.getElementById('section-analyzing').classList.add('flex'); // Add flex for centering
            
            // Set Youtube Video
            if(url.includes('v=')) {
                const videoId = url.split('v=')[1];
                if(videoId) {
                    document.getElementById('youtube-frame').src = `https://www.youtube.com/embed/${videoId.split('&')[0]}`;
                }
            }

            // Simulate Loading
            let progress = 0;
            const bar = document.getElementById('progress-bar');
            const text = document.getElementById('analyzing-text');
            const stepsText = [
                "Menganalisis struktur teks & semantik...",
                "Membuat diagram visual & mencari video...",
                "Menyusun naskah narasi audio...",
                "Merancang studi kasus & aktivitas kinestetik...",
                "Membuat soal evaluasi otomatis...",
                "Selesai! Menyiapkan antarmuka..."
            ];
            
            const badges = ['visual', 'audio', 'kinestetik', 'quiz'];
            
            const interval = setInterval(() => {
                progress += 1; 
                bar.style.width = `${progress}%`;
                
                let textIndex = Math.floor((progress / 100) * (stepsText.length - 1));
                text.innerText = stepsText[textIndex];

                // Badges Animation
                let badgeIndex = Math.floor((progress / 100) * badges.length);
                if (badgeIndex < badges.length) {
                    const badge = document.getElementById(`step-${badges[badgeIndex]}`);
                    if (badge && !badge.classList.contains('text-cyan-600')) {
                          badge.classList.remove('text-gray-500', 'bg-gray-100', 'dark:bg-white/5');
                          // Add active classes
                          badge.classList.add('text-cyan-600', 'dark:text-cyan-400', 'bg-cyan-100', 'dark:bg-cyan-500/10', 'border-cyan-500/30', 'font-bold', 'animate-pulse');
                          if(badgeIndex > 0) {
                              document.getElementById(`step-${badges[badgeIndex-1]}`).classList.remove('animate-pulse');
                          }
                    }
                }

                if (progress >= 100) {
                    clearInterval(interval);
                    document.getElementById('result-title').innerText = title;
                    document.getElementById('section-analyzing').classList.add('hidden');
                    document.getElementById('section-analyzing').classList.remove('flex');
                    document.getElementById('section-learning').classList.remove('hidden');
                    document.getElementById('btn-reset').classList.remove('hidden');
                    document.getElementById('btn-reset').classList.add('flex');
                    renderQuizzes();
                    lucide.createIcons();
                }
            }, 50); 
        }

        function switchTab(tab) {
            ['visual', 'audio', 'kinestetik'].forEach(t => {
                document.getElementById(`content-${t}`).classList.add('hidden');
                
                const btn = document.getElementById(`tab-btn-${t}`);
                btn.className = "flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-xl font-semibold transition-all duration-300 text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-black/5 dark:hover:bg-white/5";
            });

            document.getElementById(`content-${tab}`).classList.remove('hidden');
            
            const activeBtn = document.getElementById(`tab-btn-${tab}`);
            let gradientClass = "bg-gradient-to-r from-cyan-500 to-blue-500";
            if(tab === 'audio') gradientClass = "bg-gradient-to-r from-violet-500 to-purple-500";
            if(tab === 'kinestetik') gradientClass = "bg-gradient-to-r from-rose-500 to-orange-500";
            
            activeBtn.className = `flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-xl font-semibold transition-all duration-300 text-white shadow-lg ${gradientClass}`;
            
            lucide.createIcons();
        }

        function toggleAudio() {
            if ('speechSynthesis' in window) {
                if (isSpeaking) {
                    window.speechSynthesis.cancel();
                    isSpeaking = false;
                    document.getElementById('btn-audio-control').innerHTML = '<i data-lucide="play" class="w-5 h-5"></i> Putar Audio';
                    document.getElementById('btn-audio-control').classList.remove('bg-red-500', 'hover:bg-red-600', 'shadow-red-500/30');
                    document.getElementById('btn-audio-control').classList.add('bg-violet-600', 'hover:bg-violet-500', 'shadow-violet-500/30');
                } else {
                    const utterance = new SpeechSynthesisUtterance(narrativeText);
                    utterance.lang = 'id-ID';
                    utterance.rate = 0.9;
                    utterance.onend = () => { isSpeaking = false; toggleAudio(); };
                    window.speechSynthesis.speak(utterance);
                    isSpeaking = true;
                    document.getElementById('btn-audio-control').innerHTML = '<i data-lucide="pause" class="w-5 h-5"></i> Stop Audio';
                    document.getElementById('btn-audio-control').classList.remove('bg-violet-600', 'hover:bg-violet-500', 'shadow-violet-500/30');
                    document.getElementById('btn-audio-control').classList.add('bg-red-500', 'hover:bg-red-600', 'shadow-red-500/30');
                }
                lucide.createIcons();
            } else {
                alert("Browser Anda tidak mendukung Text-to-Speech.");
            }
        }

        function renderQuizzes() {
            ['visual', 'audio', 'kinestetik'].forEach(type => {
                const container = document.getElementById(`quiz-${type}-container`);
                container.innerHTML = '';
                quizzes[type].forEach((q, idx) => {
                    let html = `<div class="bg-white/50 dark:bg-[#0B0F19] border border-gray-200 dark:border-white/5 p-4 rounded-xl mb-3 hover:border-gray-300 dark:hover:border-white/10 transition-colors">
                        <p class="font-semibold mb-3 text-gray-800 dark:text-gray-200 text-sm">${idx + 1}. ${q.q}</p>
                        <div class="space-y-2">`;
                    
                    q.opts.forEach((opt, optIdx) => {
                        html += `<label class="flex items-center gap-3 cursor-pointer p-3 hover:bg-gray-100 dark:hover:bg-white/5 rounded-lg border border-gray-200 dark:border-white/5 transition-all group">
                            <div class="relative flex items-center">
                                <input type="radio" name="q-${type}-${idx}" value="${optIdx}" class="peer h-4 w-4 appearance-none rounded-full border border-gray-400 dark:border-gray-500 checked:border-${type === 'visual' ? 'cyan' : type === 'audio' ? 'violet' : 'rose'}-500 transition-all">
                                <div class="absolute left-1/2 top-1/2 h-2 w-2 -translate-x-1/2 -translate-y-1/2 rounded-full bg-${type === 'visual' ? 'cyan' : type === 'audio' ? 'violet' : 'rose'}-500 opacity-0 peer-checked:opacity-100 transition-opacity"></div>
                            </div>
                            <span class="text-sm text-gray-600 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-gray-200 transition-colors">${opt}</span>
                        </label>`;
                    });
                    
                    html += `</div></div>`;
                    container.innerHTML += html;
                });
            });
        }

        function checkQuiz(type) {
            let score = 0;
            const questions = quizzes[type];
            let allAnswered = true;

            questions.forEach((q, idx) => {
                const selected = document.querySelector(`input[name="q-${type}-${idx}"]:checked`);
                // Find parent container
                const parentDiv = document.getElementsByName(`q-${type}-${idx}`)[0].closest('div.p-4');

                // Reset styles
                parentDiv.classList.remove('border-emerald-500/50', 'border-red-500/50', 'bg-emerald-100', 'dark:bg-emerald-900/10', 'bg-red-100', 'dark:bg-red-900/10');

                if (selected) {
                    if (parseInt(selected.value) === q.ans) {
                        score++;
                        parentDiv.classList.add('border-emerald-500/50', 'bg-emerald-100', 'dark:bg-emerald-900/10');
                    } else {
                        parentDiv.classList.add('border-red-500/50', 'bg-red-100', 'dark:bg-red-900/10');
                    }
                } else {
                    allAnswered = false;
                }
            });

            if (!allAnswered) {
                alert("Jawab semua soal dulu ya!");
                return;
            }

            const resultDiv = document.getElementById(`result-${type}`);
            resultDiv.innerText = `Skor Kamu: ${score} / ${questions.length}`;
            resultDiv.classList.remove('hidden', 'bg-emerald-100', 'dark:bg-emerald-500/20', 'text-emerald-600', 'dark:text-emerald-300', 'bg-orange-100', 'dark:bg-orange-500/20', 'text-orange-600', 'dark:text-orange-300');
            
            if (score === questions.length) {
                resultDiv.classList.add('bg-emerald-100', 'dark:bg-emerald-500/20', 'text-emerald-600', 'dark:text-emerald-300', 'border', 'border-emerald-500/30');
            } else {
                resultDiv.classList.add('bg-orange-100', 'dark:bg-orange-500/20', 'text-orange-600', 'dark:text-orange-300', 'border', 'border-orange-500/30');
            }

            currentScores[type] = (score / questions.length) * 100;
            checkAIAnalysis();
        }

        function checkAIAnalysis() {
            const hasScore = Object.values(currentScores).some(s => s > 0);
            if (hasScore) {
                const analysisCard = document.getElementById('ai-analysis-card');
                analysisCard.classList.remove('hidden');
                
                let bestMethod = Object.keys(currentScores).reduce((a, b) => currentScores[a] > currentScores[b] ? a : b);
                let msg = "";
                
                const methodColor = bestMethod === 'visual' ? 'text-cyan-600 dark:text-cyan-400' : bestMethod === 'audio' ? 'text-violet-600 dark:text-violet-400' : 'text-rose-600 dark:text-rose-400';
                
                if (currentScores[bestMethod] === 100) {
                    msg = `Luar biasa! Berdasarkan interaksi latihan, AI mendeteksi kamu memiliki retensi informasi yang sangat kuat melalui metode <span class="${methodColor} font-bold uppercase">${bestMethod}</span>. Pertahankan strategi ini!`;
                } else {
                    msg = `Analisis awal menunjukkan kamu cukup responsif terhadap metode <span class="${methodColor} font-bold uppercase">${bestMethod}</span>. Cobalah ulangi bagian materi tersebut untuk mencapai *mastery* 100%.`;
                }
                
                document.getElementById('ai-analysis-text').innerHTML = msg;
                lucide.createIcons(); 
            }
        }

        function resetApp() {
            window.location.reload();
        }

    </script>
</body>
</html>