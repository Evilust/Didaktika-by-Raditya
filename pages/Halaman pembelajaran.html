<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Pendidikan Adaptif - Siklus Air</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons CDN -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        /* Animasi Custom */
        @keyframes fade-in {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in { animation: fade-in 0.5s ease-out forwards; }
        
        @keyframes slide-up {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-slide-up { animation: slide-up 0.6s ease-out forwards; }

        @keyframes spin-slow {
            to { transform: rotate(360deg); }
        }
        .animate-spin-slow { animation: spin-slow 10s linear infinite; }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        .animate-shimmer {
            animation: shimmer 2s infinite;
        }
        
        @keyframes pulse-slow {
            0%, 100% { opacity: 1; }
            50% { opacity: .7; }
        }
        .animate-pulse-slow { animation: pulse-slow 3s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
    </style>
</head>
<body class="min-h-screen bg-sky-50 text-slate-800 pb-12">

    <!-- HEADER -->
    <header class="bg-blue-600 text-white p-6 shadow-lg relative overflow-hidden">
        <div class="absolute top-0 right-0 p-4 opacity-10">
            <i data-lucide="brain" class="w-32 h-32"></i>
        </div>
        <div class="max-w-4xl mx-auto flex items-center justify-between relative z-10">
            <div>
                <h1 class="text-3xl font-bold flex items-center gap-2">
                    <i data-lucide="sparkles" class="h-6 w-6 text-yellow-300"></i>
                    AI Pendidikan Adaptif
                </h1>
                <p class="text-blue-100 mt-1">Platform Konversi Materi Otomatis</p>
            </div>
            <button id="btn-reset" onclick="resetApp()" class="hidden md:flex items-center gap-2 bg-blue-700 hover:bg-blue-800 px-4 py-2 rounded-lg text-sm transition-colors hidden">
                <i data-lucide="rotate-ccw" class="w-4 h-4"></i> Buat Materi Baru
            </button>
        </div>
    </header>

    <main class="max-w-4xl mx-auto p-4 md:p-6">
        
        <!-- SECTION 1: INPUT GURU -->
        <div id="section-input" class="max-w-2xl mx-auto animate-fade-in">
            <div class="bg-white rounded-2xl shadow-xl overflow-hidden border border-slate-200">
                <div class="bg-slate-50 p-6 border-b border-slate-100">
                    <h2 class="text-xl font-bold text-slate-800 flex items-center gap-2">
                        <i data-lucide="file-text" class="text-blue-600"></i>
                        Input Materi Pembelajaran
                    </h2>
                    <p class="text-slate-500 text-sm mt-1">Masukkan materi mentah, AI akan mengubahnya menjadi 3 metode belajar.</p>
                </div>
                
                <div class="p-6 space-y-6">
                    <!-- Judul -->
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Judul Materi / Topik</label>
                        <input id="input-title" type="text" class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition-all" value="Siklus Hidrologi (Air)">
                    </div>

                    <!-- Konten -->
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Teks Materi</label>
                        <textarea id="input-content" class="w-full p-3 border border-slate-300 rounded-lg h-64 focus:ring-2 focus:ring-blue-500 outline-none text-sm leading-relaxed transition-all">Siklus air (hidrologi) adalah proses sirkulasi air yang terus-menerus terjadi dari atmosfer ke bumi dan kembali lagi ke atmosfer. Proses ini menjamin ketersediaan air di bumi untuk makhluk hidup.

Tahapan utama:
1. Evaporasi (Penguapan): Air laut menguap karena panas matahari menjadi uap gas.
2. Kondensasi (Pengembunan): Uap air mendingin menjadi titik air dan membentuk awan.
3. Presipitasi (Hujan): Awan yang berat menurunkan air kembali ke bumi.
4. Infiltrasi: Air hujan meresap ke dalam pori-pori tanah menjadi air tanah.</textarea>
                    </div>

                    <!-- URL -->
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 mb-2">Link Video YouTube</label>
                        <div class="flex items-center gap-2 border border-slate-300 rounded-lg p-3 focus-within:ring-2 focus-within:ring-blue-500 transition-all">
                            <i data-lucide="link" class="text-slate-400 w-5 h-5"></i>
                            <input id="input-url" type="text" class="w-full outline-none text-slate-700 placeholder-slate-400" value="https://www.youtube.com/watch?v=9pqh6cmEOhs">
                        </div>
                    </div>
                    
                    <!-- Button -->
                    <div class="pt-4 flex flex-col items-center">
                        <button onclick="startAnalysis()" class="w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white px-8 py-4 rounded-xl font-bold shadow-lg transform active:scale-95 transition-all flex items-center justify-center gap-2 text-lg">
                            <i data-lucide="sparkles" class="animate-pulse"></i>
                            Generate Smart Content
                        </button>
                    </div>
                </div>
            </div>
            <div class="mt-6 text-center bg-yellow-50 text-yellow-800 p-3 rounded-lg text-xs border border-yellow-200">
                <strong>Mode Demo HTML:</strong> Form sudah diisi otomatis. Klik tombol untuk memulai.
            </div>
        </div>

        <!-- SECTION 2: ANALYZING (LOADING) -->
        <div id="section-analyzing" class="hidden flex flex-col items-center justify-center min-h-[500px] bg-white rounded-2xl shadow-xl p-8 text-center animate-fade-in">
            <div class="relative mb-8">
                <div class="absolute inset-0 bg-blue-100 rounded-full animate-ping opacity-50"></div>
                <div class="bg-white p-4 rounded-full shadow-lg relative z-10 border-4 border-blue-50">
                    <i data-lucide="cpu" class="w-16 h-16 text-blue-600 animate-pulse"></i>
                </div>
            </div>

            <h2 class="text-2xl font-bold text-slate-800 mb-2">AI Sedang Bekerja</h2>
            <p id="analyzing-text" class="text-slate-500 mb-8 h-6 font-medium text-lg">Menganalisis struktur teks...</p>

            <!-- Progress Bar -->
            <div class="w-full max-w-md bg-slate-100 rounded-full h-4 mb-4 overflow-hidden border border-slate-200">
                <div id="progress-bar" class="bg-gradient-to-r from-blue-500 to-indigo-500 h-full rounded-full transition-all duration-300 ease-out relative w-0">
                    <div class="absolute inset-0 bg-white/20 animate-shimmer"></div>
                </div>
            </div>
            
            <!-- Badges -->
            <div class="flex gap-2 mt-4 text-xs text-slate-400" id="step-indicators">
                <div id="step-visual" class="px-3 py-1 rounded-full bg-slate-100 transition-all duration-300">Visual</div>
                <div id="step-audio" class="px-3 py-1 rounded-full bg-slate-100 transition-all duration-300">Audio</div>
                <div id="step-kinestetik" class="px-3 py-1 rounded-full bg-slate-100 transition-all duration-300">Kinestetik</div>
                <div id="step-quiz" class="px-3 py-1 rounded-full bg-slate-100 transition-all duration-300">Quiz</div>
            </div>
        </div>

        <!-- SECTION 3: LEARNING CONTENT -->
        <div id="section-learning" class="hidden animate-slide-up space-y-8">
            <!-- Title Bar -->
            <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200 flex items-center justify-between">
                <div>
                    <span class="text-xs font-bold text-blue-600 uppercase tracking-wider">Materi Aktif</span>
                    <h2 id="result-title" class="text-xl font-bold text-slate-800">Judul Materi</h2>
                </div>
                <div class="flex gap-2">
                    <span class="bg-green-100 text-green-700 text-xs px-2 py-1 rounded-md font-medium flex items-center gap-1"><i data-lucide="check-circle" class="w-3 h-3"></i> Visual</span>
                    <span class="bg-green-100 text-green-700 text-xs px-2 py-1 rounded-md font-medium flex items-center gap-1"><i data-lucide="check-circle" class="w-3 h-3"></i> Audio</span>
                    <span class="bg-green-100 text-green-700 text-xs px-2 py-1 rounded-md font-medium flex items-center gap-1"><i data-lucide="check-circle" class="w-3 h-3"></i> Kinestetik</span>
                </div>
            </div>

            <!-- Tabs Navigation -->
            <div class="flex flex-wrap gap-2 bg-white p-2 rounded-xl shadow-sm">
                <button onclick="switchTab('visual')" id="tab-btn-visual" class="flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-lg font-semibold transition-all duration-200 bg-emerald-500 text-white shadow-md transform scale-105">
                    <i data-lucide="book-open" class="w-5 h-5"></i> Visual
                </button>
                <button onclick="switchTab('audio')" id="tab-btn-audio" class="flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-lg font-semibold transition-all duration-200 bg-slate-50 text-slate-600 hover:bg-slate-100">
                    <i data-lucide="volume-2" class="w-5 h-5"></i> Audio
                </button>
                <button onclick="switchTab('kinestetik')" id="tab-btn-kinestetik" class="flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-lg font-semibold transition-all duration-200 bg-slate-50 text-slate-600 hover:bg-slate-100">
                    <i data-lucide="activity" class="w-5 h-5"></i> Kinestetik
                </button>
            </div>

            <!-- Content Container -->
            <div class="bg-white rounded-2xl shadow-md min-h-[500px] overflow-hidden p-6">
                
                <!-- 1. VISUAL CONTENT -->
                <div id="content-visual" class="space-y-8 animate-fade-in">
                    <div class="flex items-center gap-2 mb-4">
                        <h2 class="text-2xl font-bold text-emerald-700">Visualisasi Siklus Air</h2>
                        <span class="bg-emerald-100 text-emerald-700 text-xs px-2 py-1 rounded-full font-bold">Animasi</span>
                    </div>

                    <p class="text-slate-600 mb-4 text-sm">Perhatikan animasi di bawah ini untuk memahami bagaimana air bergerak terus-menerus.</p>

                    <!-- SVG Diagram -->
                    <div class="w-full aspect-video bg-gradient-to-b from-sky-300 via-sky-100 to-white rounded-xl overflow-hidden relative shadow-inner border border-sky-200">
                        <svg class="w-full h-full" viewBox="0 0 800 400" preserveAspectRatio="none">
                            <!-- Matahari -->
                            <circle cx="700" cy="60" r="40" fill="#FDB813">
                                <animate attributeName="opacity" values="1;0.8;1" dur="2s" repeatCount="indefinite" />
                            </circle>
                            <circle cx="700" cy="60" r="50" fill="none" stroke="#FDB813" stroke-width="2" stroke-dasharray="5,5" class="animate-spin-slow" />

                            <!-- Gunung -->
                            <path d="M0,400 L200,150 L400,400 Z" fill="#7C90DB" opacity="0.4" />
                            <path d="M100,400 L300,100 L550,400 Z" fill="#5A71BF" />
                            
                            <!-- Tanah -->
                            <rect x="0" y="380" width="800" height="20" fill="#8B5A2B" />

                            <!-- Laut -->
                            <path d="M400,350 C500,340 700,360 800,350 L800,400 L400,400 Z" fill="#0077BE" />
                            
                            <!-- Awan -->
                            <g transform="translate(100, 50)" fill="#FFFFFF" opacity="0.9">
                                <path d="M25,25 C10,25 0,35 0,50 C0,65 15,75 25,75 L75,75 C90,75 100,65 100,50 C100,30 85,15 70,15 C60,0 35,0 25,25" />
                            </g>
                            <g transform="translate(450, 60)" fill="#FFFFFF" opacity="0.8">
                                <path d="M25,25 C10,25 0,35 0,50 C0,65 15,75 25,75 L75,75 C90,75 100,65 100,50 C100,30 85,15 70,15 C60,0 35,0 25,25" />
                            </g>

                            <!-- Panah Evaporasi (Naik) -->
                            <g stroke="#FF6B6B" stroke-width="3" fill="none" stroke-dasharray="10,5">
                                <path d="M600,350 Q620,250 600,150">
                                    <animate attributeName="stroke-dashoffset" from="100" to="0" dur="2s" repeatCount="indefinite" />
                                </path>
                                <path d="M650,360 Q670,260 650,160">
                                    <animate attributeName="stroke-dashoffset" from="100" to="0" dur="2s" repeatCount="indefinite" begin="0.5s" />
                                </path>
                            </g>
                            <text x="630" y="200" fill="#D32F2F" font-size="14" font-weight="bold">Evaporasi</text>

                            <!-- Panah Kondensasi (Geser) -->
                            <path d="M550,80 L200,80" stroke="#555" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead)" />
                            <text x="350" y="70" fill="#333" font-size="14" font-weight="bold">Kondensasi</text>

                            <!-- Hujan (Presipitasi) -->
                            <g stroke="#4FC3F7" stroke-width="2">
                                <line x1="150" y1="120" x2="140" y2="150" opacity="0.7">
                                    <animate attributeName="y1" from="120" to="300" dur="1.5s" repeatCount="indefinite" />
                                    <animate attributeName="y2" from="150" to="330" dur="1.5s" repeatCount="indefinite" />
                                </line>
                                <line x1="180" y1="130" x2="170" y2="160" opacity="0.7">
                                    <animate attributeName="y1" from="130" to="310" dur="1.2s" repeatCount="indefinite" />
                                    <animate attributeName="y2" from="160" to="340" dur="1.2s" repeatCount="indefinite" />
                                </line>
                            </g>
                            <text x="100" y="200" fill="#0277BD" font-size="14" font-weight="bold">Presipitasi</text>

                            <!-- Infiltrasi -->
                            <path d="M300,400 Q400,380 500,390" stroke="#4CAF50" stroke-width="3" fill="none" stroke-dasharray="5,5" />
                            <text x="350" y="370" fill="#1B5E20" font-size="14" font-weight="bold">Infiltrasi</text>

                             <defs>
                                <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                                    <polygon points="0 0, 10 3.5, 0 7" fill="#555" />
                                </marker>
                            </defs>
                        </svg>
                    </div>

                    <!-- Video Iframe -->
                    <div id="video-container" class="bg-slate-50 p-4 rounded-xl border border-slate-200">
                        <div class="flex items-center gap-2 mb-4">
                            <i data-lucide="youtube" class="text-red-600 w-6 h-6"></i>
                            <h3 class="font-bold text-lg text-slate-800">Video Penjelasan</h3>
                        </div>
                        <div class="aspect-video w-full rounded-lg overflow-hidden shadow-lg bg-black">
                            <iframe id="youtube-frame" width="100%" height="100%" src="" title="Video" frameborder="0" allowfullscreen></iframe>
                        </div>
                    </div>

                    <!-- Kartu Penjelasan Tahapan -->
                    <div>
                        <h3 class="font-bold text-lg text-slate-800 mb-4 flex items-center gap-2">
                            <i data-lucide="info" class="text-blue-500 w-5 h-5"></i>
                            Tahapan Proses (Detail)
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <!-- Step 1 -->
                            <div class="border-l-4 rounded-r-lg p-4 shadow-sm hover:shadow-md transition-all bg-orange-50 border-orange-200">
                                <div class="flex items-start gap-4">
                                    <div class="bg-white p-2 rounded-full shadow-sm text-orange-500">
                                        <i data-lucide="sun" class="w-6 h-6"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-bold text-lg mb-1 text-orange-800">1. Evaporasi</h4>
                                        <p class="text-sm text-gray-700 leading-relaxed">Air dari laut & sungai berubah menjadi uap air karena panas matahari. Uap ini naik ke langit.</p>
                                    </div>
                                </div>
                            </div>
                            <!-- Step 2 -->
                            <div class="border-l-4 rounded-r-lg p-4 shadow-sm hover:shadow-md transition-all bg-gray-50 border-gray-200">
                                <div class="flex items-start gap-4">
                                    <div class="bg-white p-2 rounded-full shadow-sm text-gray-500">
                                        <i data-lucide="cloud" class="w-6 h-6"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-bold text-lg mb-1 text-gray-800">2. Kondensasi</h4>
                                        <p class="text-sm text-gray-700 leading-relaxed">Uap air di langit mendingin dan berubah menjadi butiran air atau es, membentuk awan putih.</p>
                                    </div>
                                </div>
                            </div>
                            <!-- Step 3 -->
                            <div class="border-l-4 rounded-r-lg p-4 shadow-sm hover:shadow-md transition-all bg-blue-50 border-blue-200">
                                <div class="flex items-start gap-4">
                                    <div class="bg-white p-2 rounded-full shadow-sm text-blue-500">
                                        <i data-lucide="cloud-rain" class="w-6 h-6"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-bold text-lg mb-1 text-blue-800">3. Presipitasi</h4>
                                        <p class="text-sm text-gray-700 leading-relaxed">Awan yang berat menjatuhkan air kembali ke bumi dalam bentuk hujan, salju, atau hujan es.</p>
                                    </div>
                                </div>
                            </div>
                            <!-- Step 4 -->
                            <div class="border-l-4 rounded-r-lg p-4 shadow-sm hover:shadow-md transition-all bg-emerald-50 border-emerald-200">
                                <div class="flex items-start gap-4">
                                    <div class="bg-white p-2 rounded-full shadow-sm text-emerald-600">
                                        <i data-lucide="arrow-down" class="w-6 h-6"></i>
                                    </div>
                                    <div>
                                        <h4 class="font-bold text-lg mb-1 text-emerald-800">4. Infiltrasi</h4>
                                        <p class="text-sm text-gray-700 leading-relaxed">Air hujan meresap ke dalam tanah (air tanah) atau mengalir di permukaan kembali ke laut.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quiz Visual -->
                    <div class="bg-emerald-50 border-2 border-emerald-100 p-6 rounded-xl mt-8">
                        <h3 class="text-xl font-bold mb-4 flex items-center gap-2 text-emerald-700">
                            <i data-lucide="help-circle"></i> Uji Pemahaman Visual
                        </h3>
                        <div id="quiz-visual-container" class="space-y-4"></div>
                        <button onclick="checkQuiz('visual')" class="mt-4 px-6 py-2 rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white font-bold shadow-md transform active:scale-95 transition-all">Cek Jawaban</button>
                        <div id="result-visual" class="mt-2 font-bold hidden"></div>
                    </div>
                </div>

                <!-- 2. AUDIO CONTENT -->
                <div id="content-audio" class="hidden space-y-6 animate-fade-in">
                    <h2 class="text-2xl font-bold mb-6 text-amber-600 border-b pb-2">Metode Audio: Podcast Sains</h2>
                    
                    <div class="bg-amber-50 border border-amber-200 rounded-xl p-6 mb-6 flex flex-col items-center justify-center text-center shadow-inner">
                        <div class="bg-white p-4 rounded-full shadow-md mb-4">
                            <i data-lucide="volume-2" class="w-12 h-12 text-amber-500"></i>
                        </div>
                        <h3 class="text-xl font-bold text-amber-800 mb-2">Narasi: Perjalanan Si Tetes Air</h3>
                        <p class="text-amber-700 mb-6 text-sm max-w-md">Dengarkan penjelasan naratif tentang siklus air seolah-olah kamu sedang mendengar dongeng sains.</p>
                        
                        <button onclick="toggleAudio()" id="btn-audio-control" class="flex items-center gap-2 px-8 py-3 rounded-full font-bold text-white transition-all transform hover:scale-105 shadow-lg bg-amber-500 hover:bg-amber-600">
                            <i data-lucide="play" class="w-5 h-5"></i> Putar Audio
                        </button>
                    </div>

                    <div class="bg-slate-50 p-6 rounded-lg border border-slate-200">
                        <h4 class="font-bold text-slate-700 mb-3 text-sm uppercase tracking-wide">Transkrip:</h4>
                        <div id="audio-transcript" class="prose prose-sm text-slate-600 leading-relaxed max-w-none">
                            <!-- Text filled by JS -->
                        </div>
                    </div>

                    <!-- Quiz Audio -->
                    <div class="bg-amber-50 border-2 border-amber-100 p-6 rounded-xl mt-8">
                        <h3 class="text-xl font-bold mb-4 flex items-center gap-2 text-amber-700">
                            <i data-lucide="help-circle"></i> Uji Pemahaman Audio
                        </h3>
                        <div id="quiz-audio-container" class="space-y-4"></div>
                        <button onclick="checkQuiz('audio')" class="mt-4 px-6 py-2 rounded-lg bg-amber-600 hover:bg-amber-700 text-white font-bold shadow-md transform active:scale-95 transition-all">Cek Jawaban</button>
                        <div id="result-audio" class="mt-2 font-bold hidden"></div>
                    </div>
                </div>

                <!-- 3. KINESTHETIC CONTENT -->
                <div id="content-kinestetik" class="hidden space-y-6 animate-fade-in">
                    <h2 class="text-2xl font-bold mb-6 text-rose-600 border-b pb-2">Metode Kinestetik: Praktik</h2>

                    <!-- Aktivitas 1: Mini Lab -->
                    <div class="bg-white border-l-4 border-rose-500 pl-4 py-2 shadow-sm">
                        <h3 class="font-bold text-lg text-gray-800 flex items-center gap-2">
                            <span class="bg-rose-100 text-rose-600 px-2 py-1 rounded text-xs">Aktivitas 1</span>
                            Mini Lab: Membuat Hujan Buatan
                        </h3>
                        <div class="mt-4 grid md:grid-cols-2 gap-4">
                            <div class="bg-rose-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-rose-700 mb-2">Alat & Bahan:</h4>
                                <ul class="list-disc pl-5 text-sm text-gray-700 space-y-1">
                                    <li>Toples kaca bening</li>
                                    <li>Air panas</li>
                                    <li>Piring kecil (penutup toples)</li>
                                    <li>Es batu</li>
                                </ul>
                            </div>
                            <div class="bg-rose-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-rose-700 mb-2">Langkah Kerja:</h4>
                                <ol class="list-decimal pl-5 text-sm text-gray-700 space-y-1">
                                    <li>Isi toples dengan air panas (5 cm).</li>
                                    <li>Tutup rapat dengan piring kecil.</li>
                                    <li>Letakkan es batu di atas piring.</li>
                                    <li><strong>Amati:</strong> Apakah ada tetesan air jatuh?</li>
                                </ol>
                            </div>
                        </div>
                    </div>

                    <!-- Aktivitas 2: Jurnal -->
                    <div>
                        <h3 class="font-bold text-lg text-gray-800 mb-3 flex items-center gap-2">
                             <span class="bg-rose-100 text-rose-600 px-2 py-1 rounded text-xs">Aktivitas 2</span>
                             Jurnal Perjalanan Air
                        </h3>
                        <p class="text-sm text-gray-600 mb-3">
                            Bayangkan kamu adalah partikel air. Tulis cerita pendekmu dari genteng sekolah hingga ke laut!
                            Gunakan kata: <em>Limpasan</em> dan <em>Evaporasi</em>.
                        </p>
                        <textarea class="w-full border-2 border-gray-200 rounded-lg p-3 focus:border-rose-400 outline-none min-h-[120px] text-sm" placeholder="Mulai ceritamu di sini... 'Hai, namaku Tetes, aku baru saja jatuh di atap sekolah...'"></textarea>
                    </div>

                    <!-- Aktivitas 3: Studi Kasus -->
                    <div class="bg-gray-100 p-5 rounded-xl">
                       <h3 class="font-bold text-lg text-gray-800 mb-2 flex items-center gap-2">
                          <span class="bg-gray-700 text-white px-2 py-1 rounded text-xs">Studi Kasus</span>
                          Kota Tanpa Tanah?
                       </h3>
                       <p class="text-gray-700 mb-4 text-sm">
                         Di kota besar, hampir semua tanah tertutup aspal dan beton. Pohon sangat sedikit. 
                         <strong> Bagian mana dari siklus air yang paling terganggu? Apa akibatnya?</strong>
                       </p>
                    </div>

                    <!-- Quiz Kinestetik -->
                    <div class="bg-rose-50 border-2 border-rose-100 p-6 rounded-xl mt-8">
                        <h3 class="text-xl font-bold mb-4 flex items-center gap-2 text-rose-700">
                            <i data-lucide="help-circle"></i> Uji Pemahaman Praktik
                        </h3>
                        <div id="quiz-kinestetik-container" class="space-y-4"></div>
                        <button onclick="checkQuiz('kinestetik')" class="mt-4 px-6 py-2 rounded-lg bg-rose-600 hover:bg-rose-700 text-white font-bold shadow-md transform active:scale-95 transition-all">Cek Jawaban</button>
                        <div id="result-kinestetik" class="mt-2 font-bold hidden"></div>
                    </div>
                </div>

            </div>

            <!-- AI ANALYSIS RESULT -->
            <div id="ai-analysis-card" class="hidden bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl p-6 text-white shadow-xl animate-fade-in">
                <div class="flex items-start gap-4">
                    <div class="bg-white/20 p-3 rounded-full">
                        <i data-lucide="brain" class="w-8 h-8 text-white"></i>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold mb-2 flex items-center gap-2">
                            Analisis AI & Rekomendasi
                            <i data-lucide="star" class="fill-yellow-400 text-yellow-400 w-5 h-5"></i>
                        </h3>
                        <p id="ai-analysis-text" class="leading-relaxed bg-white/10 p-4 rounded-lg border border-white/20"></p>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <footer class="text-center py-6 text-slate-500 text-sm">
        <p>Â© 2024 AI Pendidikan Adaptif Indonesia. Versi HTML Murni.</p>
    </footer>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // --- DATA & STATE ---
        // Narasi Audio Diperpanjang (Storytelling)
        const narrativeText = `Halo Sobat Belajar! Pernahkah kamu berpikir, air yang kamu minum hari ini, mungkin adalah air yang sama yang pernah diminum oleh dinosaurus jutaan tahun lalu? Kok bisa? Yuk, kita telusuri perjalanannya!

Bayangkan kamu adalah setetes air di samudra yang luas. Matahari bersinar sangat terik hari ini. Tiba-tiba, kamu merasa tubuhmu menjadi ringan, hangat, dan melayang ke udara. Nah, fase ini disebut Evaporasi. Kamu berubah dari air cair menjadi uap gas yang terbang tinggi.

Semakin tinggi kamu terbang, udara semakin dingin. Brrr! Karena dingin, kamu mulai merapatkan diri dengan teman-teman uap air lainnya dan berubah kembali menjadi butiran air kecil. Kalian berkumpul membentuk awan putih yang besar. Proses perubahan dari gas kembali ke cair ini kita sebut Kondensasi.

Lama-kelamaan, awan tempatmu berkumpul semakin padat dan berat. Awan itu tidak kuat lagi menahan beban. Akhirnya... Byurr! Kamu jatuh kembali ke bumi bersama miliaran temanmu. Inilah yang kita sebut hujan, atau dalam bahasa ilmiahnya, Presipitasi.

Setelah sampai di tanah, sebagian dari kalian mengalir ke sungai dan sebagian lagi meresap masuk ke dalam pori-pori tanah, menjadi cadangan air tanah yang segar. Proses meresap ini namanya Infiltrasi.

Dan akhirnya, kamu akan mengalir kembali ke laut, menunggu matahari bersinar lagi, dan siklus pun terulang kembali. Begitulah cara alam menjaga air tetap ada untuk kita!`;

        // Data Soal Kuis
        const quizzes = {
            visual: [
                { q: "Panah merah naik dari laut menggambarkan...", opts: ["Hujan", "Evaporasi", "Aliran"], ans: 1 },
                { q: "Awan terbentuk pada proses...", opts: ["Kondensasi", "Infiltrasi", "Presipitasi"], ans: 0 },
                { q: "Gambar awan menurunkan titik-titik air disebut...", opts: ["Transpirasi", "Presipitasi", "Infiltrasi"], ans: 1 }
            ],
            audio: [
                { q: "Apa yang membuat air melayang ke udara?", opts: ["Angin", "Panas Matahari", "Gravitasi"], ans: 1 },
                { q: "Istilah untuk hujan turun adalah...", opts: ["Evaporasi", "Presipitasi", "Sublimasi"], ans: 1 },
                { q: "Ke mana perginya air setelah Infiltrasi?", opts: ["Langsung ke awan", "Masuk ke pori-pori tanah", "Menguap"], ans: 1 }
            ],
            kinestetik: [
                { q: "Fungsi es batu di percobaan adalah...", opts: ["Memanaskan", "Mendinginkan uap", "Hiasan"], ans: 1 },
                { q: "Jika tanah diaspal, proses apa yang terganggu?", opts: ["Infiltrasi", "Evaporasi", "Kondensasi"], ans: 0 },
                { q: "Apa kesimpulan dari Jurnal Perjalanan?", opts: ["Air diam", "Air berpindah (Siklus)", "Air habis"], ans: 1 }
            ]
        };

        let currentScores = { visual: 0, audio: 0, kinestetik: 0 };
        let isSpeaking = false;

        // --- INITIALIZATION ---
        lucide.createIcons();
        document.getElementById('audio-transcript').innerText = narrativeText;

        // --- FUNCTIONS ---

        function startAnalysis() {
            const title = document.getElementById('input-title').value;
            const url = document.getElementById('input-url').value;
            
            // UI Transition
            document.getElementById('section-input').classList.add('hidden');
            document.getElementById('section-analyzing').classList.remove('hidden');
            
            // Set Youtube Video
            const videoId = url.split('v=')[1];
            if(videoId) {
                document.getElementById('youtube-frame').src = `https://www.youtube.com/embed/${videoId.split('&')[0]}`;
            }

            // Simulate Loading (Diperbagus sesuai permintaan)
            let progress = 0;
            const bar = document.getElementById('progress-bar');
            const text = document.getElementById('analyzing-text');
            const stepsText = [
                "Menganalisis struktur teks & semantik...",
                "Membuat diagram visual & mencari video...",
                "Menyusun naskah narasi audio...",
                "Merancang studi kasus & aktivitas kinestetik...",
                "Membuat soal evaluasi otomatis...",
                "Selesai! Menyiapkan antarmuka..."
            ];
            
            const badges = ['visual', 'audio', 'kinestetik', 'quiz'];
            
            const interval = setInterval(() => {
                progress += 1; // Slower progress for smoother animation
                bar.style.width = `${progress}%`;
                
                // Update text steps logic (more dynamic)
                let textIndex = Math.floor((progress / 100) * (stepsText.length - 1));
                text.innerText = stepsText[textIndex];

                // Update badges (progressive lighting)
                let badgeIndex = Math.floor((progress / 100) * badges.length);
                if (badgeIndex < badges.length) {
                    const badge = document.getElementById(`step-${badges[badgeIndex]}`);
                    if (badge && !badge.classList.contains('bg-emerald-100')) {
                         badge.classList.remove('bg-slate-100');
                         badge.classList.add('bg-emerald-100', 'text-emerald-600', 'font-bold', 'animate-pulse');
                         // Remove pulse from previous
                         if(badgeIndex > 0) {
                             document.getElementById(`step-${badges[badgeIndex-1]}`).classList.remove('animate-pulse');
                         }
                    }
                }

                if (progress >= 100) {
                    clearInterval(interval);
                    document.getElementById('result-title').innerText = title;
                    document.getElementById('section-analyzing').classList.add('hidden');
                    document.getElementById('section-learning').classList.remove('hidden');
                    document.getElementById('btn-reset').classList.remove('hidden');
                    renderQuizzes();
                    lucide.createIcons();
                }
            }, 60); // Speed of loading (adjusted)
        }

        function switchTab(tab) {
            // Hide all content
            ['visual', 'audio', 'kinestetik'].forEach(t => {
                document.getElementById(`content-${t}`).classList.add('hidden');
                
                const btn = document.getElementById(`tab-btn-${t}`);
                btn.className = "flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-lg font-semibold transition-all duration-200 bg-slate-50 text-slate-600 hover:bg-slate-100";
            });

            // Show selected
            document.getElementById(`content-${tab}`).classList.remove('hidden');
            
            // Update Active Button Style
            const activeBtn = document.getElementById(`tab-btn-${tab}`);
            let colorClass = "bg-emerald-500";
            if(tab === 'audio') colorClass = "bg-amber-500";
            if(tab === 'kinestetik') colorClass = "bg-rose-500";
            
            activeBtn.className = `flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-lg font-semibold transition-all duration-200 text-white shadow-md transform scale-105 ${colorClass}`;
            
            lucide.createIcons(); // Ensure icons render if tab was previously hidden
        }

        function toggleAudio() {
            if ('speechSynthesis' in window) {
                if (isSpeaking) {
                    window.speechSynthesis.cancel();
                    isSpeaking = false;
                    document.getElementById('btn-audio-control').innerHTML = '<i data-lucide="play" class="w-5 h-5"></i> Putar Audio';
                    document.getElementById('btn-audio-control').classList.remove('bg-red-500');
                    document.getElementById('btn-audio-control').classList.add('bg-amber-500');
                } else {
                    const utterance = new SpeechSynthesisUtterance(narrativeText);
                    utterance.lang = 'id-ID';
                    utterance.rate = 0.9; // Slower rate for storytelling
                    utterance.onend = () => { isSpeaking = false; toggleAudio(); }; // Reset UI when done
                    window.speechSynthesis.speak(utterance);
                    isSpeaking = true;
                    document.getElementById('btn-audio-control').innerHTML = '<i data-lucide="pause" class="w-5 h-5"></i> Stop Audio';
                    document.getElementById('btn-audio-control').classList.remove('bg-amber-500');
                    document.getElementById('btn-audio-control').classList.add('bg-red-500');
                }
                lucide.createIcons();
            } else {
                alert("Browser Anda tidak mendukung Text-to-Speech.");
            }
        }

        function renderQuizzes() {
            ['visual', 'audio', 'kinestetik'].forEach(type => {
                const container = document.getElementById(`quiz-${type}-container`);
                container.innerHTML = '';
                quizzes[type].forEach((q, idx) => {
                    let html = `<div class="bg-white p-4 rounded-lg shadow-sm mb-2">
                        <p class="font-semibold mb-2 text-slate-800">${idx + 1}. ${q.q}</p>
                        <div class="space-y-1">`;
                    
                    q.opts.forEach((opt, optIdx) => {
                        html += `<label class="flex items-center gap-2 cursor-pointer p-2 hover:bg-gray-50 rounded border border-gray-100 transition-colors">
                            <input type="radio" name="q-${type}-${idx}" value="${optIdx}" class="accent-blue-600">
                            <span class="text-sm text-slate-700">${opt}</span>
                        </label>`;
                    });
                    
                    html += `</div></div>`;
                    container.innerHTML += html;
                });
            });
        }

        function checkQuiz(type) {
            let score = 0;
            const questions = quizzes[type];
            let allAnswered = true;

            questions.forEach((q, idx) => {
                const selected = document.querySelector(`input[name="q-${type}-${idx}"]:checked`);
                const parentDiv = document.getElementsByName(`q-${type}-${idx}`)[0].closest('.bg-white');

                // Reset styles
                parentDiv.classList.remove('border-2', 'border-green-500', 'border-red-500', 'bg-green-50', 'bg-red-50');

                if (selected) {
                    if (parseInt(selected.value) === q.ans) {
                        score++;
                        parentDiv.classList.add('border-2', 'border-green-500', 'bg-green-50');
                    } else {
                        parentDiv.classList.add('border-2', 'border-red-500', 'bg-red-50');
                    }
                } else {
                    allAnswered = false;
                }
            });

            if (!allAnswered) {
                alert("Jawab semua soal dulu ya!");
                return;
            }

            const resultDiv = document.getElementById(`result-${type}`);
            resultDiv.innerText = `Skor Kamu: ${score} / ${questions.length}`;
            resultDiv.classList.remove('hidden');
            resultDiv.className = `mt-2 font-bold p-3 rounded-lg text-center text-white shadow-md animate-fade-in ${score === questions.length ? 'bg-green-600' : 'bg-orange-500'}`;

            currentScores[type] = (score / questions.length) * 100;
            checkAIAnalysis();
        }

        function checkAIAnalysis() {
            const hasScore = Object.values(currentScores).some(s => s > 0);
            if (hasScore) {
                const analysisCard = document.getElementById('ai-analysis-card');
                analysisCard.classList.remove('hidden');
                
                let bestMethod = Object.keys(currentScores).reduce((a, b) => currentScores[a] > currentScores[b] ? a : b);
                let msg = "";
                
                if (currentScores[bestMethod] === 100) {
                    msg = `Luar biasa! Berdasarkan hasil latihan, kamu sangat menguasai materi melalui metode **${bestMethod.toUpperCase()}**. Pertahankan cara belajar ini!`;
                } else {
                    msg = `Kamu sudah mencoba. Sepertinya metode **${bestMethod.toUpperCase()}** cukup efektif untukmu, tapi cobalah ulangi bagian yang salah untuk mencapai pemahaman sempurna.`;
                }
                
                document.getElementById('ai-analysis-text').innerText = msg;
                lucide.createIcons(); // Refresh icons inside the new card
            }
        }

        function resetApp() {
            window.location.reload();
        }

    </script>
</body>
</html>